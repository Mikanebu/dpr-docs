<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Datastore - Datapackage Registry</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Datastore";
    var mkdocs_page_input_path = "developers/datastore.md";
    var mkdocs_page_url = "/developers/datastore/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Datapackage Registry</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../platform/">Platform</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Datastore</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#datapackage-registry-datastore">Datapackage Registry Datastore</a></li>
                
                    <li><a class="toctree-l4" href="#configuration">Configuration</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../api/">API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../cli/">CLI</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../authorization/">Authorization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../authentication/">Authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../infrastructure/">Infrastructure</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Publishers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/prepare/">Prepare</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/package/">Package</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/upload/">Upload</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/use/">Use</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../publishers/cli/">CLI</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Datapackage Registry</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Developers &raquo;</li>
        
      
    
    <li>Datastore</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/frictionlessdata/dpr-docs/edit/master/docs/developers/datastore.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="datapackage-registry-datastore">Datapackage Registry Datastore</h1>
<p>The Datapackage Registry uses flat file datastore to store uploaded <a href="http://specs.frictionlessdata.io/">Data Packages</a>.</p>
<ul>
<li>The Datastore runs from S3, or, an object storage which supports the S3 API.</li>
<li>The Datastore is the point of truth for data, holding the raw data sources, and the <a href="http://specs.frictionlessdata.io/">Data Package</a> that describes the sources.</li>
<li>All data coming into Datapackage Registry first hits the Datastore. From the Datastore, various services read this data and create derived databases to represent the data in certain ways. </li>
</ul>
<h2 id="configuration">Configuration</h2>
<p>In order to use the Datastore, a number of Datapackage Registry components need to be able to read and write from it. In order to do this, we suggest the following setup (those familiar with AWS and S3 may modify aspects of this as desired, as long as the user with the access keys can read and write to the bucket that provides the Datastore).</p>
<h3 id="aws-account">AWS account</h3>
<p>Setup an AWS account.</p>
<h3 id="aws-user">AWS user</h3>
<p>You need a user that has permissions to read and write to the bucket. It is best practice to not employ an actual user account for this task, but, rather, set up some user that you use for deployed services, who has only the actual access levels required to perform the needed actions. An example setup is:</p>
<ul>
<li>Go to <a href="https://console.aws.amazon.com/iam/home">AWS identity and access management console (IAM)</a> and create a new user. Make sure to enable "Programmatic access" Access type - this will create access key ID and secret access key for the AWS API.</li>
<li>Go to that user's permissions and attach an <code>AmazonS3FullAccess</code> policy (great place for fine-tuning if you are familiar with AWS)</li>
<li>Get this user's access key, secret key. The access key and secret key are used in the <code>AWS_ACCESS_KEY</code> and <code>AWS_SECRET_ACCESS_KEY</code> environment variables respectively. Make sure to copy these values to .env file</li>
</ul>
<h3 id="s3-bucket">S3 Bucket</h3>
<ul>
<li>Go to S3 management console and create a bucket that you will use as the Registry Datastore. The name of the bucket is used in the <code>S3_BUCKET_NAME</code> environment variable. Make sure to set this variable in the .env file</li>
<li>Set the region name (identifier) of the created bucket in the <code>AWS_REGION</code> environment variable or .env file. This region name should be an identifier without spaces, for ex. <code>eu-central-1</code>. See the table of available regons and their identifiers here: http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region</li>
<li>With the S3 bucket created, go to its 'Properties', then 'Permissions', then 'Edit Bucket Policy'. The policy should allow GET access to anyone, like:</li>
</ul>
<pre><code>{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;AddPerm&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Principal&quot;: &quot;*&quot;,
      &quot;Action&quot;: &quot;s3:GetObject&quot;,
      &quot;Resource&quot;: &quot;arn:aws:s3:::{YOUR_BUCKET_NAME}/*&quot;
    }
  ]
}
</code></pre>

<ul>
<li>Also in the 'Permissions' section, choose 'Edit CORS Configuration' and use this configuration:</li>
</ul>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;CORSConfiguration xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;
  &lt;CORSRule&gt;
    &lt;AllowedOrigin&gt;*&lt;/AllowedOrigin&gt;
    &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;
    &lt;AllowedMethod&gt;PUT&lt;/AllowedMethod&gt;
    &lt;AllowedMethod&gt;POST&lt;/AllowedMethod&gt;
    &lt;ExposeHeader&gt;Content-Range&lt;/ExposeHeader&gt;
    &lt;AllowedHeader&gt;*&lt;/AllowedHeader&gt;
  &lt;/CORSRule&gt;
&lt;/CORSConfiguration&gt;
</code></pre>

<h3 id="contributing-code">Contributing code</h3>
<p>Found a bug? Got neat way to refactor an existing code path? Bursting with ideas to make Datapackage Registry more awesome?</p>
<p>We <em>can't wait</em> to see your contributions. Here are a few things that will help:</p>
<ul>
<li>All open issues <a href="http://github.com/frictionlessdata/dpr-api/issues">can be found here</a>. If you are working on an existing issue, please let us know by commenting on an issue. Likewise, if you are working on something new, open an issue to let us know.</li>
<li>We follow a set of <a href="https://github.com/okfn/coding-standards">coding standards</a>, and we have simple examples of those coding standards implemented for <a href="https://github.com/okfn/oki-py">Python</a> and <a href="https://github.com/okfn/oki-js">Javascript</a>. Please do read before starting.</li>
</ul>
<p>If anything is unclear, or you just want to talk with other people working on Datapackage Registry, then catch us on <a href="http://gitter.im/frictionlessdata/chat">Gitter.im</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api/" class="btn btn-neutral float-right" title="API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../platform/" class="btn btn-neutral" title="Platform"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/frictionlessdata/dpr-docs" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../platform/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
